/*! hipsters_game 2014-07-22 */
function Player(a,b){this._username=a,this._password=b,this._created=(new Date).getTime(),this._socket=!1,this._zone="login",this._pos=[0,0],this._health=100,this._vel=[0,0],this._anim="standing",this._bag=[],this._equip={},playerCount++}function showAlert(a){$("#alert_modal div.msg").html(a),$("#alert_modal").modal("show")}var playerCount=0;Player.prototype.playerCount=function(){return playerCount},Player.prototype.login=function(a){return a!=this._password?!1:!0},Player.prototype.setSocket=function(a){this._socket=a},Player.prototype.getProfile=function(){return{username:this._username,health:this._health,vel:this._vel,bag:this._bag,equip:this._equip,zone:this._zone,pos:this._pos,created:this._created}},Player.prototype.setProfile=function(a){this._username=a.username,this._health=a.health,this._vel=a.vel,this._equip=a.equip,this._zone=a.zone,this._pos=a.pos,this._created=a.created},Player.prototype.updateDisplay=function(){console.log("display for ",this),$("#info_username").html(this._username),$("#info_zone").html(this._zone+" ["+this._pos[0]+","+this._pos[1]+"]"),$("#info_health").html(this._health)},Player.prototype.sendPing=function(){this._startPing=(new Date).getTime(),this._socket.emit("ping",{})},Player.prototype.receivePing=function(){this._endPing=(new Date).getTime(),this._latency=this._endPing-this._startPing,this._socket&&this._socket.emit("info",{latency:this._latency})},"undefined"!=typeof module&&(module.exports=Player);var cnf={title:"I was a serial killer before it was cool",ws_server:"http://10.0.33.34:8001"};CreateGame=function(a){return this._canvasID=a,this._canvasE=document.getElementById(a),this._socket=!1,this._connected=!1,this._authenticated=!1,this._zone=!1,this._player=!1,this._canvasE?(this._canvasW=$(this._canvasE).width(),this._canvasH=$(this._canvasE).height(),this.init=function(){this._p=new Phaser.Game(this._canvasW,this._canvasH,Phaser.CANVAS,this._canvasID,{preload:this.preload,create:this.create,update:this.update}),this._socket=io(cnf.ws_server);var a=this;$("#info_server").html("Connecting.."),this._socket.on("connect",function(){$("#info_server").html("Connected"),hideSpinner(),a._connected=!0,$("#login_modal").modal("show")}),this._socket.on("connect_error",function(){$("#info_server").html("Connect Failed"),a._socket.disconnect()}),this._socket.on("disconnect",function(){$("#info_server").html("Disconnected")}),this._socket.on("alert",function(a){console.log("alert",a),showAlert(a)}),this._socket.on("login",function(b){console.log("login response",b),processingLogin=!1,b.status?($("#info_server").html("Logged In"),$("#login_modal").modal("hide"),a._player=new Player(a._login_params.user,a._login_params.pwd),a._player.setProfile(b.profile),a._player.updateDisplay(),$("div.right").slideDown(),a._player.updateDisplay(),showSpinner("Loading "+a._player._zone)):(showAlert(b.err),hideSpinner())}),this._socket.on("ping",function(){a._socket.emit("ping")}),this._socket.on("info",function(a){"undefined"!=typeof a.latency&&$("#info_latency").html(a.latency+"ms"),"undefined"!=typeof a.position&&$("#info_position").html("x:"+a.position[0]+" y:"+a.position[1]),"undefined"!=typeof a.zone&&$("#info_zone").html(a.zone)})},this.preload=function(){console.log("Preloading .. ")},this.create=function(){console.log("Game created .. ")},this.update=function(){},this.doLogin=function(a){return self._connected?(showSpinner("Logging In.."),self._login_params=a,void self._socket.emit("login",a)):void console.log("Cant login not connected")},this):(alert("Missing canvas!"),!1)},console.log("hipsters_game.js loaded - yay");